<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Business Case Builder</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  
  <style>
    @media print {
      .no-print { display: none !important; }
    }
    
    .stat-card {
      transition: transform 0.2s;
    }
    
    .stat-card:hover {
      transform: translateY(-4px);
    }
    
    .lead-row {
      transition: background-color 0.15s;
    }
    
    .lead-row:hover {
      background-color: #f3f4f6;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;
    const { 
      Users, TrendingUp, DollarSign, Clock, Search, Download, 
      Eye, RefreshCw, LogOut, Calendar, Building2, Mail, Phone, 
      User, Briefcase
    } = lucide;

    const AdminDashboard = () => {
      // ============================================
      // CONFIGURA√á√ÉO
      // ============================================
      
      // IMPORTANTE: Cole aqui a URL do seu Google Apps Script (mesma do index.html)
      const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyVoIYLHiUmIbuR8s1jzk_8QX1IOh68hHvNUE-C5w9VbKllUUk70EHZYs_25euB5Xo8/exec';
      
      // Senha do admin (voc√™ pode mudar isso)
      const ADMIN_PASSWORD = 'hupdata2024';
      
      // ============================================
      // ESTADO
      // ============================================
      
      const [isAuthenticated, setIsAuthenticated] = useState(false);
      const [password, setPassword] = useState('');
      const [leads, setLeads] = useState([]);
      const [loading, setLoading] = useState(false);
      const [searchTerm, setSearchTerm] = useState('');
      const [filterArea, setFilterArea] = useState('all');
      const [filterPrioridade, setFilterPrioridade] = useState('all');
      const [selectedLead, setSelectedLead] = useState(null);
      const [showDetail, setShowDetail] = useState(false);
      const chartRef = useRef(null);
      const chartInstance = useRef(null);
      
      // ============================================
      // AUTENTICA√á√ÉO
      // ============================================
      
      useEffect(() => {
        const auth = localStorage.getItem('adminAuth');
        if (auth === ADMIN_PASSWORD) {
          setIsAuthenticated(true);
        }
      }, []);
      
      const handleLogin = (e) => {
        e.preventDefault();
        if (password === ADMIN_PASSWORD) {
          localStorage.setItem('adminAuth', password);
          setIsAuthenticated(true);
          setPassword('');
        } else {
          alert('Senha incorreta!');
        }
      };
      
      const handleLogout = () => {
        localStorage.removeItem('adminAuth');
        setIsAuthenticated(false);
        setLeads([]);
      };
      
      // ============================================
      // BUSCAR DADOS
      // ============================================
      
      const fetchLeads = async () => {
        if (!GOOGLE_APPS_SCRIPT_URL || GOOGLE_APPS_SCRIPT_URL === 'https://script.google.com/macros/s/AKfycbyVoIYLHiUmIbuR8s1jzk_8QX1IOh68hHvNUE-C5w9VbKllUUk70EHZYs_25euB5Xo8/exec') {
          console.warn('‚ö†Ô∏è Google Sheets n√£o configurado!');
          alert('‚ö†Ô∏è Google Sheets n√£o configurado!\n\nConfigure a URL do Apps Script no c√≥digo (linha ~55)\n\nEnquanto isso, o dashboard funcionar√° mas sem dados.');
          return;
        }
        
        setLoading(true);
        console.log('üì• Buscando leads do Google Sheets...');
        console.log('üîó URL:', GOOGLE_APPS_SCRIPT_URL.substring(0, 50) + '...');
        
        try {
          const response = await fetch(GOOGLE_APPS_SCRIPT_URL);
          
          console.log('üì° Resposta recebida, status:', response.status);
          
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          
          const data = await response.json();
          console.log('üìä Dados recebidos:', data);
          
          if (data.success) {
            const leadsCarregados = data.leads || [];
            setLeads(leadsCarregados);
            console.log(`‚úÖ ${leadsCarregados.length} leads carregados com sucesso!`);
          } else {
            console.error('‚ùå Erro na resposta:', data.message);
            alert('Erro ao buscar leads:\n\n' + data.message + '\n\nVerifique o console (F12) para mais detalhes.');
          }
        } catch (error) {
          console.error('‚ùå ERRO ao conectar com Google Sheets:', error);
          console.error('üîç Verifique:');
          console.error('   1. URL do Apps Script est√° correta?');
          console.error('   2. Apps Script foi implantado como "Aplicativo da Web"?');
          console.error('   3. Acesso est√° configurado como "Qualquer pessoa"?');
          console.error('   4. Voc√™ autorizou as permiss√µes?');
          
          alert('‚ö†Ô∏è Erro ao conectar com Google Sheets!\n\nVerifique o console (F12) para mais detalhes.\n\nO dashboard continuar√° funcionando, mas sem dados.');
          
          // Define leads vazio para n√£o quebrar a interface
          setLeads([]);
        } finally {
          setLoading(false);
        }
      };
      
      useEffect(() => {
        if (isAuthenticated) {
          fetchLeads();
        }
      }, [isAuthenticated]);
      
      // ============================================
      // FILTROS E BUSCA
      // ============================================
      
      const filteredLeads = leads.filter(lead => {
        const matchSearch = !searchTerm || 
          lead.Nome?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          lead.Email?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          lead.Empresa?.toLowerCase().includes(searchTerm.toLowerCase());
        
        const matchArea = filterArea === 'all' || lead.√Årea === filterArea;
        const matchPrioridade = filterPrioridade === 'all' || lead.Prioridade === filterPrioridade;
        
        return matchSearch && matchArea && matchPrioridade;
      });
      
      // ============================================
      // ESTAT√çSTICAS
      // ============================================
      
      const stats = {
        total: leads.length,
        investimentoTotal: leads.reduce((sum, lead) => {
          const valor = parseFloat(lead['ROI - Investimento']) || 0;
          return sum + valor;
        }, 0),
        economiaAnual: leads.reduce((sum, lead) => {
          const valor = parseFloat(lead['ROI - Economia Anual']) || 0;
          return sum + valor;
        }, 0),
        paybackMedio: leads.length > 0 ? leads.reduce((sum, lead) => {
          const valor = parseFloat(lead['ROI - Payback (meses)']) || 0;
          return sum + valor;
        }, 0) / leads.length : 0
      };
      
      const areaDistribution = leads.reduce((acc, lead) => {
        const area = lead.√Årea || 'N√£o informado';
        acc[area] = (acc[area] || 0) + 1;
        return acc;
      }, {});
      
      // ============================================
      // GR√ÅFICO
      // ============================================
      
      useEffect(() => {
        if (chartRef.current && leads.length > 0) {
          if (chartInstance.current) {
            chartInstance.current.destroy();
          }
          
          const ctx = chartRef.current.getContext('2d');
          chartInstance.current = new Chart(ctx, {
            type: 'doughnut',
            data: {
              labels: Object.keys(areaDistribution),
              datasets: [{
                data: Object.values(areaDistribution),
                backgroundColor: [
                  '#032c62',
                  '#17203c',
                  '#8c95ae',
                  '#3b82f6',
                  '#60a5fa',
                  '#93c5fd'
                ]
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  position: 'bottom'
                }
              }
            }
          });
        }
        
        return () => {
          if (chartInstance.current) {
            chartInstance.current.destroy();
          }
        };
      }, [leads]);
      
      // ============================================
      // EXPORT CSV
      // ============================================
      
      const exportToCSV = () => {
        if (filteredLeads.length === 0) {
          alert('Nenhum lead para exportar!');
          return;
        }
        
        const headers = Object.keys(filteredLeads[0]);
        const csvContent = [
          headers.join(','),
          ...filteredLeads.map(lead => 
            headers.map(header => {
              const value = lead[header] || '';
              return `"${value.toString().replace(/"/g, '""')}"`;
            }).join(',')
          )
        ].join('\n');
        
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `leads-business-case-${new Date().toISOString().split('T')[0]}.csv`;
        link.click();
      };
      
      // ============================================
      // TELA DE LOGIN
      // ============================================
      
      if (!isAuthenticated) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 flex items-center justify-center p-4">
            <div className="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
              <div className="text-center mb-8">
                <img 
                  src="https://hupdata.com/wp-content/uploads/2023/06/logo-hupdata-horizontal-color.png" 
                  alt="HupData Logo" 
                  className="h-12 mx-auto mb-4"
                />
                <h1 className="text-2xl font-bold text-gray-900 mb-2">Admin Dashboard</h1>
                <p className="text-gray-600">Acesso restrito ao time comercial</p>
              </div>
              
              <form onSubmit={handleLogin}>
                <div className="mb-6">
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Senha de Acesso
                  </label>
                  <input
                    type="password"
                    value={password}
                    onChange={(e) => setPassword(e.target.value)}
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Digite a senha"
                    required
                  />
                </div>
                
                <button
                  type="submit"
                  className="w-full bg-[#032c62] text-white py-3 rounded-lg hover:bg-[#17203c] transition-colors font-medium"
                >
                  Entrar
                </button>
              </form>
              
              <p className="text-xs text-gray-500 text-center mt-6">
                Se voc√™ n√£o tem acesso, contate o administrador
              </p>
            </div>
          </div>
        );
      }
      
      // ============================================
      // TELA DE DETALHES DO LEAD
      // ============================================
      
      if (showDetail && selectedLead) {
        return (
          <div className="min-h-screen bg-gray-50 p-4">
            <div className="max-w-4xl mx-auto">
              <div className="bg-white rounded-2xl shadow-lg p-8">
                <div className="flex justify-between items-center mb-6">
                  <h2 className="text-2xl font-bold text-gray-900">Detalhes do Lead</h2>
                  <button
                    onClick={() => setShowDetail(false)}
                    className="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"
                  >
                    ‚Üê Voltar
                  </button>
                </div>
                
                <div className="space-y-6">
                  {/* Informa√ß√µes B√°sicas */}
                  <div>
                    <h3 className="text-lg font-semibold text-gray-800 mb-3">Informa√ß√µes B√°sicas</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div className="flex items-start gap-3">
                        <User className="w-5 h-5 text-blue-600 mt-1" />
                        <div>
                          <p className="text-sm text-gray-600">Nome</p>
                          <p className="font-medium text-gray-900">{selectedLead.Nome || '-'}</p>
                        </div>
                      </div>
                      <div className="flex items-start gap-3">
                        <Mail className="w-5 h-5 text-blue-600 mt-1" />
                        <div>
                          <p className="text-sm text-gray-600">Email</p>
                          <p className="font-medium text-gray-900">{selectedLead.Email || '-'}</p>
                        </div>
                      </div>
                      <div className="flex items-start gap-3">
                        <Phone className="w-5 h-5 text-blue-600 mt-1" />
                        <div>
                          <p className="text-sm text-gray-600">WhatsApp</p>
                          <p className="font-medium text-gray-900">{selectedLead.WhatsApp || '-'}</p>
                        </div>
                      </div>
                      <div className="flex items-start gap-3">
                        <Briefcase className="w-5 h-5 text-blue-600 mt-1" />
                        <div>
                          <p className="text-sm text-gray-600">Cargo</p>
                          <p className="font-medium text-gray-900">{selectedLead.Cargo || '-'}</p>
                        </div>
                      </div>
                      <div className="flex items-start gap-3">
                        <Building2 className="w-5 h-5 text-blue-600 mt-1" />
                        <div>
                          <p className="text-sm text-gray-600">Empresa</p>
                          <p className="font-medium text-gray-900">{selectedLead.Empresa || '-'}</p>
                        </div>
                      </div>
                      <div className="flex items-start gap-3">
                        <Calendar className="w-5 h-5 text-blue-600 mt-1" />
                        <div>
                          <p className="text-sm text-gray-600">Data</p>
                          <p className="font-medium text-gray-900">
                            {selectedLead.Timestamp ? new Date(selectedLead.Timestamp).toLocaleString('pt-BR') : '-'}
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  {/* Diagn√≥stico */}
                  <div>
                    <h3 className="text-lg font-semibold text-gray-800 mb-3">Diagn√≥stico</h3>
                    <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
                      <div className="bg-blue-50 rounded-lg p-3">
                        <p className="text-sm text-blue-700">√Årea</p>
                        <p className="font-bold text-blue-900">{selectedLead.√Årea || '-'}</p>
                      </div>
                      <div className="bg-blue-50 rounded-lg p-3">
                        <p className="text-sm text-blue-700">Processos</p>
                        <p className="font-bold text-blue-900">{selectedLead['N√∫mero de Processos'] || '-'}</p>
                      </div>
                      <div className="bg-blue-50 rounded-lg p-3">
                        <p className="text-sm text-blue-700">% Manual</p>
                        <p className="font-bold text-blue-900">{selectedLead['Percentual Manual'] || '-'}%</p>
                      </div>
                      <div className="bg-blue-50 rounded-lg p-3">
                        <p className="text-sm text-blue-700">Prioridade</p>
                        <p className="font-bold text-blue-900">{selectedLead.Prioridade || '-'}</p>
                      </div>
                      <div className="bg-blue-50 rounded-lg p-3">
                        <p className="text-sm text-blue-700">Erros Frequentes</p>
                        <p className="font-bold text-blue-900">{selectedLead['Erros Frequentes'] || '-'}</p>
                      </div>
                      <div className="bg-blue-50 rounded-lg p-3">
                        <p className="text-sm text-blue-700">Sistemas</p>
                        <p className="font-bold text-blue-900 text-xs">{selectedLead['Sistemas Utilizados'] || '-'}</p>
                      </div>
                    </div>
                  </div>
                  
                  {/* ROI */}
                  <div>
                    <h3 className="text-lg font-semibold text-gray-800 mb-3">An√°lise de ROI</h3>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                      <div className="bg-green-50 rounded-lg p-4">
                        <p className="text-sm text-green-700 mb-1">Investimento</p>
                        <p className="text-xl font-bold text-green-900">
                          {selectedLead['ROI - Investimento'] ? 
                            parseFloat(selectedLead['ROI - Investimento']).toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'}) : '-'}
                        </p>
                      </div>
                      <div className="bg-green-50 rounded-lg p-4">
                        <p className="text-sm text-green-700 mb-1">Economia Mensal</p>
                        <p className="text-xl font-bold text-green-900">
                          {selectedLead['ROI - Economia Mensal'] ? 
                            parseFloat(selectedLead['ROI - Economia Mensal']).toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'}) : '-'}
                        </p>
                      </div>
                      <div className="bg-green-50 rounded-lg p-4">
                        <p className="text-sm text-green-700 mb-1">Economia Anual</p>
                        <p className="text-xl font-bold text-green-900">
                          {selectedLead['ROI - Economia Anual'] ? 
                            parseFloat(selectedLead['ROI - Economia Anual']).toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'}) : '-'}
                        </p>
                      </div>
                      <div className="bg-green-50 rounded-lg p-4">
                        <p className="text-sm text-green-700 mb-1">Payback</p>
                        <p className="text-xl font-bold text-green-900">
                          {selectedLead['ROI - Payback (meses)'] || '-'} meses
                        </p>
                      </div>
                    </div>
                  </div>
                  
                  {/* Implementa√ß√£o */}
                  <div>
                    <h3 className="text-lg font-semibold text-gray-800 mb-3">Implementa√ß√£o</h3>
                    <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
                      <div className="bg-purple-50 rounded-lg p-3">
                        <p className="text-sm text-purple-700">Complexidade</p>
                        <p className="font-bold text-purple-900">{selectedLead['ROI - Complexidade'] || '-'}</p>
                      </div>
                      <div className="bg-purple-50 rounded-lg p-3">
                        <p className="text-sm text-purple-700">Tempo (semanas)</p>
                        <p className="font-bold text-purple-900">
                          {selectedLead['ROI - Tempo M√≠nimo (semanas)']}-{selectedLead['ROI - Tempo Total (semanas)']}
                        </p>
                      </div>
                      <div className="bg-purple-50 rounded-lg p-3">
                        <p className="text-sm text-purple-700">Estrat√©gia</p>
                        <p className="font-bold text-purple-900 text-xs">{selectedLead['ROI - Estrat√©gia'] || '-'}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }
      
      // ============================================
      // DASHBOARD PRINCIPAL
      // ============================================
      
      return (
        <div className="min-h-screen bg-gray-50">
          {/* Header */}
          <div className="bg-white shadow-sm border-b no-print">
            <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
              <div className="flex items-center gap-4">
                <img 
                  src="https://hupdata.com/wp-content/uploads/2023/06/logo-hupdata-horizontal-color.png" 
                  alt="HupData Logo" 
                  className="h-8"
                />
                <h1 className="text-xl font-bold text-gray-900">Admin Dashboard</h1>
              </div>
              
              <div className="flex gap-2">
                <button
                  onClick={fetchLeads}
                  disabled={loading}
                  className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2"
                >
                  <RefreshCw className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} />
                  Atualizar
                </button>
                
                <button
                  onClick={handleLogout}
                  className="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2"
                >
                  <LogOut className="w-4 h-4" />
                  Sair
                </button>
              </div>
            </div>
          </div>
          
          <div className="max-w-7xl mx-auto px-4 py-8">
            {/* Estat√≠sticas */}
            <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
              <div className="bg-white rounded-xl shadow-md p-6 stat-card">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600 mb-1">Total de Leads</p>
                    <p className="text-3xl font-bold text-gray-900">{stats.total}</p>
                  </div>
                  <Users className="w-12 h-12 text-blue-600" />
                </div>
              </div>
              
              <div className="bg-white rounded-xl shadow-md p-6 stat-card">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600 mb-1">Investimento Total</p>
                    <p className="text-2xl font-bold text-gray-900">
                      {stats.investimentoTotal.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL', maximumFractionDigits: 0})}
                    </p>
                  </div>
                  <DollarSign className="w-12 h-12 text-green-600" />
                </div>
              </div>
              
              <div className="bg-white rounded-xl shadow-md p-6 stat-card">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600 mb-1">Economia Anual</p>
                    <p className="text-2xl font-bold text-gray-900">
                      {stats.economiaAnual.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL', maximumFractionDigits: 0})}
                    </p>
                  </div>
                  <TrendingUp className="w-12 h-12 text-purple-600" />
                </div>
              </div>
              
              <div className="bg-white rounded-xl shadow-md p-6 stat-card">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600 mb-1">Payback M√©dio</p>
                    <p className="text-3xl font-bold text-gray-900">
                      {stats.paybackMedio.toFixed(1)} <span className="text-lg">meses</span>
                    </p>
                  </div>
                  <Clock className="w-12 h-12 text-orange-600" />
                </div>
              </div>
            </div>
            
            {/* Gr√°fico */}
            <div className="bg-white rounded-xl shadow-md p-6 mb-8">
              <h3 className="text-lg font-semibold text-gray-900 mb-4">Distribui√ß√£o por √Årea</h3>
              <div className="h-64">
                <canvas ref={chartRef}></canvas>
              </div>
            </div>
            
            {/* Filtros */}
            <div className="bg-white rounded-xl shadow-md p-6 mb-6 no-print">
              <div className="flex flex-wrap gap-4">
                <div className="flex-1 min-w-64">
                  <div className="relative">
                    <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" />
                    <input
                      type="text"
                      placeholder="Buscar por nome, email ou empresa..."
                      value={searchTerm}
                      onChange={(e) => setSearchTerm(e.target.value)}
                      className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    />
                  </div>
                </div>
                
                <select
                  value={filterArea}
                  onChange={(e) => setFilterArea(e.target.value)}
                  className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                >
                  <option value="all">Todas as √°reas</option>
                  {Object.keys(areaDistribution).map(area => (
                    <option key={area} value={area}>{area}</option>
                  ))}
                </select>
                
                <select
                  value={filterPrioridade}
                  onChange={(e) => setFilterPrioridade(e.target.value)}
                  className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                >
                  <option value="all">Todas as prioridades</option>
                  <option value="alta">Alta</option>
                  <option value="media">M√©dia</option>
                  <option value="baixa">Baixa</option>
                </select>
                
                <button
                  onClick={exportToCSV}
                  className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2"
                >
                  <Download className="w-4 h-4" />
                  Exportar CSV
                </button>
              </div>
              
              <div className="mt-4 flex gap-2 flex-wrap">
                <span className="text-sm text-gray-600">Resultados:</span>
                <span className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
                  {filteredLeads.length} de {leads.length} leads
                </span>
              </div>
            </div>
            
            {/* Tabela de Leads */}
            <div className="bg-white rounded-xl shadow-md overflow-hidden">
              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-gray-50 border-b">
                    <tr>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Data
                      </th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Nome
                      </th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Empresa
                      </th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        √Årea
                      </th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Prioridade
                      </th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Economia Anual
                      </th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Payback
                      </th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        A√ß√µes
                      </th>
                    </tr>
                  </thead>
                  <tbody className="bg-white divide-y divide-gray-200">
                    {filteredLeads.map((lead, index) => (
                      <tr key={index} className="lead-row">
                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                          {lead.Timestamp ? new Date(lead.Timestamp).toLocaleDateString('pt-BR') : '-'}
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap">
                          <div className="text-sm font-medium text-gray-900">{lead.Nome || '-'}</div>
                          <div className="text-sm text-gray-500">{lead.Email || '-'}</div>
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                          {lead.Empresa || '-'}
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                          {lead.√Årea || '-'}
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap">
                          <span className={`px-2 py-1 text-xs rounded-full ${
                            lead.Prioridade === 'alta' ? 'bg-red-100 text-red-800' :
                            lead.Prioridade === 'media' ? 'bg-yellow-100 text-yellow-800' :
                            'bg-green-100 text-green-800'
                          }`}>
                            {lead.Prioridade || '-'}
                          </span>
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600">
                          {lead['ROI - Economia Anual'] ? 
                            parseFloat(lead['ROI - Economia Anual']).toLocaleString('pt-BR', {style: 'currency', currency: 'BRL', maximumFractionDigits: 0}) : '-'}
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                          {lead['ROI - Payback (meses)'] ? `${lead['ROI - Payback (meses)']} meses` : '-'}
                        </td>
                        <td className="px-6 py-4 whitespace-nowrap text-sm">
                          <button
                            onClick={() => {
                              setSelectedLead(lead);
                              setShowDetail(true);
                            }}
                            className="text-blue-600 hover:text-blue-900 flex items-center gap-1"
                          >
                            <Eye className="w-4 h-4" />
                            Ver detalhes
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
              
              {filteredLeads.length === 0 && (
                <div className="text-center py-12">
                  <p className="text-gray-500">Nenhum lead encontrado</p>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<AdminDashboard />, document.getElementById('root'));
  </script>
</body>
</html>
